{% extends "base.html" %}
{% load static %}

{% block title %}My Wishlist - Gadget Shop{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/amazon-style.css' %}">
<style>
.wishlist-header {
    background: linear-gradient(135deg, #e74c3c, #c0392b);
    color: white;
    padding: 40px 20px;
    text-align: center;
    border-radius: 8px;
    margin-bottom: 30px;
}

.wishlist-item {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    display: flex;
    gap: 20px;
    transition: all 0.3s ease;
    position: relative;
}

.wishlist-item:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transform: translateY(-2px);
}

.wishlist-image {
    width: 150px;
    height: 150px;
    object-fit: contain;
    border-radius: 6px;
}

.wishlist-details {
    flex: 1;
}

.wishlist-actions {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-width: 150px;
}

.heart-icon {
    position: absolute;
    top: 15px;
    right: 15px;
    color: #e74c3c;
    font-size: 20px;
}

.price-alert {
    background: #d4edda;
    border: 1px solid #c3e6cb;
    color: #155724;
    padding: 8px 12px;
    border-radius: 4px;
    font-size: 12px;
    margin-top: 10px;
}
</style>
{% endblock %}

{% block content %}
<div class="amazon-container">
    <!-- Wishlist Header -->
    <div class="wishlist-header">
        <h1 style="font-size: 36px; margin-bottom: 10px;">‚ù§Ô∏è My Wishlist</h1>
        <p style="font-size: 18px; margin: 0;">{{ wishlist_count }} item{{ wishlist_count|pluralize }} saved for later</p>
    </div>

    {% if products %}
        <!-- Wishlist Items -->
        {% for product in products %}
            <div class="wishlist-item">
                <div class="heart-icon">‚ù§Ô∏è</div>
                
                <img src="{% if product.image %}{{ product.image.url }}{% else %}https://via.placeholder.com/150x150?text=No+Image{% endif %}" 
                     alt="{{ product.name }}" class="wishlist-image"
                     onerror="this.src='https://via.placeholder.com/150x150?text=No+Image'">
                
                <div class="wishlist-details">
                    <h3 style="margin-bottom: 10px;">
                        <a href="{{ product.get_absolute_url }}" style="color: #333; text-decoration: none;">
                            {{ product.name }}
                        </a>
                    </h3>
                    
                    <div style="margin-bottom: 10px;">
                        <div class="amazon-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</div>
                        <span style="color: #666; font-size: 14px;">({{ product.id|add:47 }} reviews)</span>
                    </div>
                    
                    <div style="font-size: 24px; font-weight: bold; color: #B12704; margin-bottom: 10px;">
                        ‚Çπ{{ product.price|floatformat:2 }}
        <h1 class="wishlist-title">‚ù§Ô∏è My Wishlist</h1>
        <p class="wishlist-count">{{ wishlist_count }} item{{ wishlist_count|pluralize }} saved for later</p>
                    <div style="color: #067d62; font-weight: 500; margin-bottom: 10px;">
                        {% if product.stock > 0 %}
                            ‚úÖ In Stock ({{ product.stock }} available)
                        {% else %}
                            ‚ùå Out of Stock
                         {% endif %} 
                    </div>
                    
                    <div style="font-size: 14px; color: #666;">
                        Added to wishlist on {{ product.created|date:"M j, Y" }}
                    </div>
                    
                    <!-- Price Alert Feature -->
                    <h3 class="wishlist-product-title">
                        <a href="{{ product.get_absolute_url }}" class="wishlist-product-link">
                            {{ product.name }}
                        </a>
                    </h3>
                <div class="wishlist-actions">
                    <div class="wishlist-rating-row">
                        <div class="amazon-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</div>
                        <span class="wishlist-review-count">({{ product.id|add:47 }} reviews)</span>
                    </div>
                                üõí Add to Cart
                    <div class="wishlist-product-price">
                        </form>
                    <div class="wishlist-stock-status">
                        <form method="post" action="{% url 'shop:buy_now' product.id %}">
                    <div class="wishlist-added-date">
                            <button type="submit" class="amazon-btn amazon-btn-secondary" style="width: 100%; background: #ff9900;">
                            <button type="submit" class="amazon-btn amazon-btn-primary wishlist-btn-fullwidth" title="Add to Cart">
                            </button>
                            <button type="submit" class="amazon-btn amazon-btn-secondary wishlist-btn-fullwidth wishlist-btn-buynow" title="Buy Now">
                    {% empty %}
                        <button class="amazon-btn wishlist-btn-fullwidth wishlist-btn-disabled" type="button" title="Out of Stock" disabled>
                            Out of Stock
                    <a href="{% url 'shop:add_to_compare' product.id %}" class="amazon-btn amazon-btn-secondary wishlist-btn-fullwidth" title="Compare Product">
                    
                    <button type="button" onclick="removeFromWishlist({{ product.id }})" class="amazon-btn wishlist-btn-fullwidth wishlist-btn-remove" title="Remove from Wishlist">
                    <a href="{% url 'shop:add_to_compare' product.id %}" class="amazon-btn amazon-btn-secondary" style="width: 100%;">
                    <button type="button" onclick="shareProduct({{ product.id }})" class="amazon-btn amazon-btn-secondary wishlist-btn-fullwidth" title="Share Product">
                    </a>
        <div class="wishlist-actions-row">
            <button type="button" onclick="addAllToCart()" class="amazon-btn amazon-btn-primary wishlist-btn-large" title="Add All to Cart">
                üõí Add All to Cart
            </button>
            <button type="button" onclick="clearWishlist()" class="amazon-btn wishlist-btn-large wishlist-btn-removeall" title="Clear Wishlist">
                ÔøΩÔ∏è Clear Wishlist
            </button>
        </div>
                </div>
            <div class="wishlist-empty-icon">üíî</div>
        {% endfor %}
            <a href="{% url 'products:product_list' %}" class="amazon-btn amazon-btn-primary wishlist-btn-large" title="Start Shopping">
        <!-- Wishlist Actions -->
        <div class="wishlist-actions-row">
            <button onclick="addAllToCart()" class="amazon-btn amazon-btn-primary wishlist-btn-large" title="Add All to Cart">
                üõí Add All to Cart
            </button>
            <button onclick="clearWishlist()" class="amazon-btn wishlist-btn-large wishlist-btn-removeall" title="Clear Wishlist">
                üóëÔ∏è Clear Wishlist
            </button>
        </div>
        
    {% else %}
        <!-- Empty Wishlist -->
        <div class="amazon-empty-cart">
            <div style="font-size: 80px; margin-bottom: 20px;">üíî</div>
            <h2>Your wishlist is empty</h2>
            <p>Save items you love for later by clicking the heart icon ‚ù§Ô∏è</p>
            <a href="{% url 'products:product_list' %}" class="amazon-btn amazon-btn-primary wishlist-btn-large" title="Start Shopping">
                üõçÔ∏è Start Shopping
            </a>
        </div>
    {% endif %}
</div>

<script>
function removeFromWishlist(productId) {
    if (confirm('Remove this item from your wishlist?')) {
        // Implementation for removing from wishlist
        window.location.reload();
    }
}

function shareProduct(productId) {
    if (navigator.share) {
        navigator.share({
            title: 'Check out this product!',
            url: window.location.origin + '/products/' + productId + '/'
        });
    } else {
        // Fallback for browsers without Web Share API
        const url = window.location.origin + '/products/' + productId + '/';
        navigator.clipboard.writeText(url).then(() => {
            alert('Product link copied to clipboard!');
        });
    }
}

function addAllToCart() {
    if (confirm('Add all wishlist items to cart?')) {
        // Implementation for adding all to cart
        alert('All available items added to cart!');
    }
}

function clearWishlist() {
    if (confirm('Are you sure you want to clear your entire wishlist?')) {
        // Implementation for clearing wishlist
        window.location.reload();
    }
}
</script>
{% endblock %}