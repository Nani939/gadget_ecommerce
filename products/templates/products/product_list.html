{% extends "base.html" %}
{% load static %}

{% block title %}All Products - Gadget Shop{% endblock %}

{% block extra_css %}
{% endblock %}
{% block content %}
<style>/* ===============================
 Global Container
================================= */
.amazon-container {
  font-family: 'Inter', sans-serif;
  color: #111;
  line-height: 1.6;
  padding: 20px;
  background: #f8f9fa;
}

/* ===============================
   Breadcrumb
================================= */
.amazon-breadcrumb {
  font-size: 0.9rem;
  margin-bottom: 20px;
  color: #555;
}

.amazon-breadcrumb a {
  color: #007185;
  text-decoration: none;
}

.amazon-breadcrumb a:hover {
  text-decoration: underline;
}

/* ===============================
   Page Header
================================= */
.product-list-header {
  margin-bottom: 25px;
}

.product-list-title {
  font-size: 2rem;
  font-weight: 700;
  margin-bottom: 5px;
}

.product-list-count {
  font-size: 0.95rem;
  color: #555;
}

/* ===============================
   Filters & Sort
================================= */
.product-list-filters {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  gap: 15px;
  margin-bottom: 30px;
  background: #fff;
  padding: 15px 20px;
  border-radius: 10px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.05);
}

.product-list-filter-group,
.product-list-sort-group {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}

.product-list-filter-label,
.product-list-sort-label {
  font-weight: 600;
  font-size: 0.95rem;
}

.product-list-select,
.product-list-sort-select {
  padding: 8px 12px;
  border-radius: 6px;
  border: 1px solid #ddd;
  background: #fff;
  font-size: 0.95rem;
}

/* ===============================
   Product Grid
================================= */
.amazon-product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 25px;
}

.amazon-product-card {
  background: #fff;
  border-radius: 12px;
  padding: 15px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.05);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.amazon-product-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 5px 14px rgba(0,0,0,0.08);
}

.amazon-product-image {
  text-align: center;
}

.amazon-product-image img {
  max-height: 200px;
  object-fit: contain;
}

/* Title */
.amazon-product-title {
  font-size: 1rem;
  font-weight: 600;
  color: #007185;
  text-decoration: none;
  display: block;
  margin-bottom: 8px;
}

.amazon-product-title:hover {
  text-decoration: underline;
}

/* Rating */
.amazon-product-rating {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.9rem;
  margin-bottom: 6px;
}

.amazon-stars {
  color: #ffa41c;
  font-size: 1rem;
}

.amazon-rating-count {
  color: #007185;
  font-size: 0.85rem;
}

/* Price */
.amazon-product-price {
  display: flex;
  align-items: baseline;
  gap: 10px;
  margin-bottom: 6px;
}

.amazon-price {
  font-size: 1.2rem;
  font-weight: 700;
  color: #B12704;
}

.product-list-old-price {
  font-size: 0.9rem;
  text-decoration: line-through;
  color: #888;
}

.product-list-discount {
  font-size: 0.9rem;
  color: #007600;
  font-weight: 600;
}

/* Prime Badge */
.product-list-prime-row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
}

.product-list-prime-badge {
  background: #00a8e1;
  color: #fff;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
}

.product-list-prime-delivery {
  font-size: 0.85rem;
  color: #333;
}

/* Stock */
.product-list-stock-status {
  font-size: 0.9rem;
  margin-bottom: 8px;
  font-weight: 500;
  color: #007600;
}

.product-list-stock-status:contains("unavailable"),
.product-list-stock-status:contains("Out") {
  color: #B12704;
}

/* Actions */
.amazon-product-actions {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-top: auto;
}

.product-list-btn-fullwidth {
  width: 100%;
}

.product-list-btn-disabled {
  width: 100%;
  background: #ddd !important;
  color: #888 !important;
  cursor: not-allowed;
}

/* Wishlist */
.product-list-wishlist-form {
  margin-top: 6px;
  text-align: right;
}

.product-list-wishlist-btn {
  background: none;
  border: none;
  color: #B12704;
  font-size: 1.2rem;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.product-list-wishlist-btn:hover {
  transform: scale(1.2);
}

/* Additional Info */
.product-list-additional-info {
  font-size: 0.85rem;
  color: #555;
  margin-top: 6px;
}

/* ===============================
   Pagination
================================= */
.product-list-pagination {
  margin-top: 30px;
  text-align: center;
}

.product-list-pagination-group {
  display: inline-flex;
  gap: 8px;
  align-items: center;
}

.product-list-pagination-current {
  font-weight: 700;
  color: #111;
}

.product-list-pagination-ellipsis {
  color: #555;
}

/* ===============================
   Empty State
================================= */
.amazon-empty-cart {
  text-align: center;
  padding: 60px 20px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.05);
}

.amazon-empty-cart h2 {
  font-size: 1.5rem;
  margin: 20px 0 10px;
}

.amazon-empty-cart p {
  font-size: 1rem;
  margin-bottom: 20px;
}

/* ===============================
   Recently Viewed
================================= */
.product-list-recently-viewed {
  margin-top: 50px;
}

.product-list-recently-title {
  font-size: 1.4rem;
  font-weight: 700;
  margin-bottom: 15px;
}

.product-list-recently-link {
  color: #007185;
  font-size: 0.95rem;
  text-decoration: none;
}

.product-list-recently-link:hover {
  text-decoration: underline;
}

/* ===============================
   Responsive
================================= */
@media (max-width: 768px) {
  .product-list-filters {
    flex-direction: column;
    gap: 12px;
  }

  .amazon-product-grid {
    grid-template-columns: 1fr 1fr;
  }
}

@media (max-width: 500px) {
  .amazon-product-grid {
    grid-template-columns: 1fr;
  }
}
</style>
<div class="amazon-container">
  <!-- Breadcrumb -->
  <div class="amazon-breadcrumb">
    <a href="{% url 'shop:home' %}">Home</a> › 
    <span>All Products</span>
  </div>

  <!-- Page Header -->
  <div class="product-list-header">
    <h1 class="product-list-title">All Products</h1>
    <div class="product-list-count">{{ products|length }} result{{ products|length|pluralize }} for "all products"</div>
  </div>

  <!-- Filters and Sort -->
  <div class="product-list-filters">
    <div class="product-list-filter-group">
      <span class="product-list-filter-label">Filter by:</span>
      <select class="amazon-form-input product-list-select" title="Filter by Category">
        <option>All Categories</option>
        <option>Electronics</option>
        <option>Accessories</option>
        <option>Mobile Phones</option>
      </select>
      <select class="amazon-form-input product-list-select" title="Filter by Brand">
        <option>All Brands</option>
        <option>Apple</option>
        <option>Samsung</option>
        <option>OnePlus</option>
      </select>
    </div>
    <div class="product-list-sort-group">
      <span class="product-list-sort-label">Sort by:</span>
      <select class="amazon-form-input product-list-sort-select" title="Sort Products">
        <option>Featured</option>
        <option>Price: Low to High</option>
        <option>Price: High to Low</option>
        <option>Customer Reviews</option>
        <option>Newest Arrivals</option>
      </select>
    </div>
  </div>

  <!-- Products Grid -->
  {% if products %}
    <div class="amazon-product-grid">
      {% for product in products %}
        <div class="amazon-product-card">
          <!-- Product Image -->
          <div class="amazon-product-image">
            <a href="{{ product.get_absolute_url }}">
              <img src="{% if product.image %}{{ product.image.url }}{% else %}https://via.placeholder.com/200x200?text=No+Image{% endif %}" 
                   alt="{{ product.name }}"
                   onerror="this.src='https://via.placeholder.com/200x200?text=No+Image'">
            </a>
          </div>

          <!-- Product Info -->
          <div>
            <a href="{{ product.get_absolute_url }}" class="amazon-product-title">
              {{ product.name }}
            </a>

            <!-- Rating (Mock data for demo) -->
            <div class="amazon-product-rating">
              <div class="amazon-stars">★★★★☆</div>
              <a href="#" class="amazon-rating-count">({{ product.id|add:10 }})</a>
            </div>

            <!-- Price -->
            <div class="amazon-product-price">
              <div class="amazon-price">
                <span class="amazon-price-symbol">₹</span>{{ product.get_discounted_price|floatformat:2 }}
              </div>
              {% if product.discount > 0 %}
                <div class="product-list-old-price">
                  ₹{{ product.price|floatformat:2 }}
                </div>
                <div class="product-list-discount">
                  {{ product.discount }}% off
                </div>
              {% endif %}
            </div>

            <!-- Prime Badge (Mock) -->
            {% if product.available %}
              <div class="product-list-prime-row">
                <span class="product-list-prime-badge">prime</span>
                <span class="product-list-prime-delivery">FREE delivery</span>
              </div>
            {% endif %}

            <!-- Stock Status -->
            <div class="product-list-stock-status">
              {% if product.available %}
                In Stock
              {% else %}
                Currently unavailable
              {% endif %}
            </div>

            <!-- Action Buttons -->
            <div class="amazon-product-actions">
              {% if product.available and product.stock > 0 %}
              <form method="post" action="{% url 'shop:add_to_cart' product.id %}" class="product-list-action-form">
                {% csrf_token %}
                <input type="hidden" name="quantity" value="1">
                <button type="submit" class="amazon-btn amazon-btn-primary product-list-btn-fullwidth">
                  <i class="fas fa-cart-plus"></i> Add to Cart
                </button>
              </form>
              
              <form method="post" action="{% url 'shop:buy_now' product.id %}" class="product-list-action-form">
                {% csrf_token %}
                <input type="hidden" name="quantity" value="1">
                <button type="submit" class="amazon-btn amazon-btn-secondary product-list-btn-fullwidth">
                  <i class="fas fa-bolt"></i> Buy Now
                </button>
              </form>
              {% else %}
              <button class="amazon-btn product-list-btn-disabled" type="button" disabled>
                <i class="fas fa-times"></i> {% if product.stock <= 0 %}Out of Stock{% else %}Unavailable{% endif %}
              </button>
              {% endif %}
              <!-- Wishlist Button -->
              <form method="post" action="{% url 'shop:add_to_wishlist' product.id %}" class="product-list-wishlist-form">
                {% csrf_token %}
                <button type="submit" title="Add to Wishlist" class="product-list-wishlist-btn">
                  <i class="fas fa-heart"></i>
                </button>
              </form>
            </div>

            <!-- Additional Info -->
            <div class="product-list-additional-info">
              <div>Ships from Gadget Shop</div>
              {% if product.id|divisibleby:4 %}
                <div>Climate Pledge Friendly</div>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Pagination (if needed) -->
    <div class="product-list-pagination">
        <div class="product-list-pagination-group">
          <button class="amazon-btn amazon-btn-secondary" disabled>Previous</button>
          <span class="product-list-pagination-current">1</span>
          <button class="amazon-btn amazon-btn-secondary">2</button>
          <button class="amazon-btn amazon-btn-secondary">3</button>
          <span class="product-list-pagination-ellipsis">...</span>
          <button class="amazon-btn amazon-btn-secondary">Next</button>
        </div>
      </div>

  {% else %}
    <!-- No Products -->
    <div class="amazon-empty-cart">
      <div class="amazon-empty-cart-icon">
        <i class="fas fa-box-open" style="font-size: 80px; opacity: 0.5;"></i>
      </div>
      <h2>No products found</h2>
      <p>We couldn't find any products matching your criteria.</p>
      <a href="{% url 'shop:home' %}" class="amazon-btn amazon-btn-primary">
        <i class="fas fa-home"></i> Go to Homepage
      </a>
    </div>
  {% endif %}

  <!-- Recently Viewed -->
  <div class="product-list-recently-viewed">
    <h2 class="product-list-recently-title">Your recently viewed items</h2>
    <div class="product-list-recently-link-row">
      <a href="#" class="amazon-action-link product-list-recently-link">
        <i class="fas fa-history"></i> View or edit your browsing history
      </a>
    </div>
  </div>
</div>
{% endblock %}
